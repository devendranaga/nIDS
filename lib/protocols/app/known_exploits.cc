#include <known_exploits.h>

namespace firewall {

//
// List of known exploits.. taken from the internet.
//
const static struct {
    Port_Numbers port_id;
    event_description evt_desc;
    std::string alias;
    std::string more_details;
    bool is_worm;
} exploit_map[] = {
    {
        // Win32.Msblast.I -> check microsoft website for more details
        Port_Numbers::Port_Number_MSBlast_CmdCtrl,

        event_description::Evt_Known_Exploit_Win32_Blaster,

        "Worm:Win32/Msblast.I",

        "Win32/Msblast.I is a network worm that can spread to "
        "a computer running Microsoft Windows 2000 and Windows XP "
        "that does not have Security Update MS03-026 or MS03-039 installed.",

		true
	},
};

exploit_match::exploit_match() { }
exploit_match::~exploit_match() { }

bool exploit_match::match(Port_Numbers port_id)
{
    for (auto it : exploit_map) {
        if (it.port_id == port_id) {
            return true;
        }
    }

    return false;
}

std::string exploit_match::get_alias(Port_Numbers port_id)
{
    for (auto it : exploit_map) {
        if (it.port_id == port_id) {
            return it.alias;
        }
    }

    return "";
}

std::string exploit_match::get_descr(Port_Numbers port_id)
{
    for (auto it : exploit_map) {
        if (it.port_id == port_id) {
            return it.more_details;
        }
    }

    return "";
}

event_description exploit_match::get_matching_evt_desc(Port_Numbers port_id)
{
    for (auto it : exploit_map) {
        if (it.port_id == port_id) {
            return it.evt_desc;
        }
    }

    return event_description::Evt_Unknown_Error;
}

}
